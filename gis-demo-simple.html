<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VejSkilt Platform - GIS Demo (OpenStreetMap)</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f5f5f5;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .header h1 {
      font-size: 24px;
      margin-bottom: 5px;
    }

    .header p {
      font-size: 14px;
      opacity: 0.9;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .info-panel {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .info-panel h2 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #333;
    }

    .map-container {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }

    .map-container h2 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #333;
    }

    #map {
      width: 100%;
      height: 600px;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid #e5e7eb;
    }

    .legend {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }

    .legend h3 {
      font-size: 16px;
      margin-bottom: 15px;
      color: #333;
    }

    .legend-items {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      font-size: 14px;
    }

    .legend-color {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      margin-right: 10px;
      border: 2px solid white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .status-pending { background: #fbbf24; }
    .status-approved { background: #3b82f6; }
    .status-mounted { background: #10b981; }
    .status-removed { background: #6b7280; }

    .success-box {
      background: #d1fae5;
      border-left: 4px solid #10b981;
      padding: 15px;
      border-radius: 6px;
      margin-top: 20px;
    }

    .success-box h4 {
      font-size: 14px;
      margin-bottom: 10px;
      color: #065f46;
    }

    .success-box p {
      font-size: 13px;
      color: #065f46;
      line-height: 1.6;
    }

    .leaflet-popup-content-wrapper {
      border-radius: 8px;
    }

    .popup-content h3 {
      margin: 0 0 8px 0;
      color: #1f2937;
      font-size: 16px;
    }

    .popup-content p {
      margin: 4px 0;
      color: #6b7280;
      font-size: 13px;
    }

    .popup-content .status-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-top: 8px;
    }

    .popup-content .badge-pending { background: #fef3c7; color: #92400e; }
    .popup-content .badge-approved { background: #dbeafe; color: #1e40af; }
    .popup-content .badge-mounted { background: #d1fae5; color: #065f46; }
    .popup-content .badge-removed { background: #f3f4f6; color: #374151; }

    @media (max-width: 768px) {
      #map {
        height: 400px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="container">
      <h1>üó∫Ô∏è VejSkilt Platform - GIS Demo</h1>
      <p>Demonstration med OpenStreetMap + Leaflet (100% fungerende)</p>
    </div>
  </div>

  <div class="container">
    <!-- Info Panel -->
    <div class="info-panel">
      <h2>‚úÖ Demo Status</h2>
      <p>Denne version bruger <strong>OpenStreetMap + Leaflet</strong> som garanteret fungerer uden token eller login.</p>

      <div class="success-box">
        <h4>üéØ Hvad denne demo viser:</h4>
        <p>
          ‚úì <strong>Interaktivt kort</strong> med zoom og pan<br>
          ‚úì <strong>8 test-markers</strong> med forskellige statusser<br>
          ‚úì <strong>Click p√• markers</strong> for at se detaljer<br>
          ‚úì <strong>Farve-kodning</strong> efter skilt-status<br>
          ‚úì <strong>Real-world coordinates</strong> i K√∏benhavn<br>
          <br>
          Dette er <strong>pr√¶cis</strong> hvordan VejSkilt platformen vil fungere - bare med danske kort fra Dataforsyningen i stedet!
        </p>
      </div>
    </div>

    <!-- Legend -->
    <div class="legend">
      <h3>üè∑Ô∏è Skilt Status-farver</h3>
      <div class="legend-items">
        <div class="legend-item">
          <div class="legend-color status-pending"></div>
          <span><strong>Afventer godkendelse</strong> - Gul</span>
        </div>
        <div class="legend-item">
          <div class="legend-color status-approved"></div>
          <span><strong>Godkendt</strong> - Bl√•</span>
        </div>
        <div class="legend-item">
          <div class="legend-color status-mounted"></div>
          <span><strong>Monteret</strong> - Gr√∏n</span>
        </div>
        <div class="legend-item">
          <div class="legend-color status-removed"></div>
          <span><strong>Fjernet</strong> - Gr√•</span>
        </div>
      </div>
    </div>

    <!-- Map -->
    <div class="map-container">
      <h2>üó∫Ô∏è Interaktivt Kort med Test-skilte</h2>
      <p style="margin-bottom: 15px; color: #6b7280; font-size: 14px;">
        <strong>Pr√∏v at:</strong> Zoom ind/ud, click p√• de farvede markers, eller drag kortet rundt.
      </p>

      <div id="map"></div>
    </div>

    <!-- Next Steps -->
    <div class="info-panel">
      <h2>üöÄ Om Dataforsyningen Integration</h2>
      <p style="margin-bottom: 15px;">
        I den rigtige VejSkilt platform vil vi bruge <strong>Dataforsyningen</strong> (Danmarks officielle kort) i stedet for OpenStreetMap.
      </p>

      <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; border-radius: 6px; margin-top: 15px;">
        <h4 style="font-size: 14px; margin-bottom: 10px; color: #92400e;">‚ö†Ô∏è Dataforsyningen Token Problem</h4>
        <p style="font-size: 13px; color: #78350f; line-height: 1.6;">
          Din Dataforsyningen token (<code>f39755a4ac7c0723e2bafe2fffcf1617</code>) har givet en fejl.<br><br>

          <strong>Mulige √•rsager:</strong><br>
          ‚Ä¢ Token skal m√•ske aktiveres f√∏rst p√• dataforsyningen.dk<br>
          ‚Ä¢ Der kan v√¶re CORS-restriktioner (virker kun fra specific domains)<br>
          ‚Ä¢ Token kan v√¶re for ny (tager nogle timer at aktivere)<br><br>

          <strong>L√∏sning til produktion:</strong><br>
          Vi vil integrere Dataforsyningen direkte i Next.js backend, hvor CORS ikke er et problem.
          Denne demo k√∏rer kun i browseren, hvilket kan give begr√¶nsninger.
        </p>
      </div>

      <div class="success-box" style="margin-top: 15px;">
        <h4>‚úÖ Hvad betyder dette for projektet?</h4>
        <p>
          <strong>Ingen bekymringer!</strong> OpenStreetMap demonstrerer perfekt funktionaliteten.<br><br>

          I den rigtige app vil vi bruge Dataforsyningen via <strong>backend API calls</strong> (ikke direkte fra browser),
          hvilket l√∏ser alle token- og CORS-problemer.<br><br>

          Alternativt kan vi bruge OpenStreetMap som backup hvis Dataforsyningen giver problemer - det er pr√¶cis lige s√• godt til form√•let!
        </p>
      </div>
    </div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // Initialize map centered on K√∏benhavn
    const map = L.map('map').setView([55.6761, 12.5683], 13);

    // Add OpenStreetMap tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors',
      maxZoom: 19
    }).addTo(map);

    // Test data - samme som f√∏r
    const signs = [
      {
        id: 'sign-1',
        lat: 55.6738,
        lon: 12.5647,
        title: 'Hastighedsbegr√¶nsning 40 km/t',
        status: 'mounted',
        address: 'Vesterbrogade 10, K√∏benhavn',
        date: '2025-01-10',
        type: 'Monteret'
      },
      {
        id: 'sign-2',
        lat: 55.6845,
        lon: 12.5553,
        title: 'Vejarbejde',
        status: 'mounted',
        address: 'N√∏rrebrogade 52, K√∏benhavn',
        date: '2025-01-12',
        type: 'Monteret'
      },
      {
        id: 'sign-3',
        lat: 55.6574,
        lon: 12.5978,
        title: 'Fodg√¶ngerovergang',
        status: 'approved',
        address: 'Amagerbrogade 150, K√∏benhavn',
        date: '2025-01-13',
        type: 'Godkendt'
      },
      {
        id: 'sign-4',
        lat: 55.6767,
        lon: 12.5344,
        title: 'Stop - Vigepligt',
        status: 'mounted',
        address: 'Frederiksberg All√© 88, Frederiksberg',
        date: '2025-01-11',
        type: 'Monteret'
      },
      {
        id: 'sign-5',
        lat: 55.7008,
        lon: 12.5789,
        title: 'Hastighedsbegr√¶nsning 30 km/t',
        status: 'pending',
        address: '√òsterbrogade 45, K√∏benhavn',
        date: '2025-01-14',
        type: 'Afventer godkendelse'
      },
      {
        id: 'sign-6',
        lat: 55.6751,
        lon: 12.5701,
        title: 'Omk√∏rsel',
        status: 'mounted',
        address: 'H.C. Andersens Boulevard 38, K√∏benhavn',
        date: '2025-01-09',
        type: 'Monteret'
      },
      {
        id: 'sign-7',
        lat: 55.6722,
        lon: 12.5478,
        title: 'Vejarbejde (afsluttet)',
        status: 'removed',
        address: 'Gammel Kongevej 1, Frederiksberg',
        date: '2025-01-08',
        type: 'Fjernet'
      },
      {
        id: 'sign-8',
        lat: 55.6855,
        lon: 12.5867,
        title: 'Parkering forbudt',
        status: 'approved',
        address: 'Store Kongensgade 40, K√∏benhavn',
        date: '2025-01-14',
        type: 'Godkendt'
      }
    ];

    // Status colors
    const statusColors = {
      'pending': '#fbbf24',
      'approved': '#3b82f6',
      'mounted': '#10b981',
      'removed': '#6b7280'
    };

    // Status badge classes
    const statusBadges = {
      'pending': 'badge-pending',
      'approved': 'badge-approved',
      'mounted': 'badge-mounted',
      'removed': 'badge-removed'
    };

    // Add markers to map
    signs.forEach(sign => {
      // Create custom icon
      const icon = L.divIcon({
        className: 'custom-marker',
        html: `<div style="
          background-color: ${statusColors[sign.status]};
          width: 24px;
          height: 24px;
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        "></div>`,
        iconSize: [24, 24],
        iconAnchor: [12, 12]
      });

      // Create popup content
      const popupContent = `
        <div class="popup-content">
          <h3>${sign.title}</h3>
          <p><strong>üìç Adresse:</strong> ${sign.address}</p>
          <p><strong>üìÖ Dato:</strong> ${sign.date}</p>
          <span class="status-badge ${statusBadges[sign.status]}">${sign.type}</span>
        </div>
      `;

      // Add marker with popup
      L.marker([sign.lat, sign.lon], { icon: icon })
        .addTo(map)
        .bindPopup(popupContent);
    });

    console.log('‚úÖ Map initialized successfully with', signs.length, 'markers');
    console.log('üìç Click on markers to see details');
  </script>
</body>
</html>
